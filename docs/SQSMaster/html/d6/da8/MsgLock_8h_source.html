<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SQSMaster: src/MsgLock.h Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SQSMaster
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">SQSMaster-SJTU</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d6/da8/MsgLock_8h.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">MsgLock.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d6/da8/MsgLock_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef MSGLOCK_H</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define MSGLOCK_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00013"></a>00013 
<a name="l00018"></a><a class="code" href="../../d5/da5/classEvent.html">00018</a> <span class="keyword">class </span><a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a>
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020 <span class="keyword">public</span>:
<a name="l00025"></a><a class="code" href="../../d5/da5/classEvent.html#a8e493c850490cee46d90c553eec37a1c">00025</a>         <span class="keyword">typedef</span> void (*<a class="code" href="../../d5/da5/classEvent.html#a8e493c850490cee46d90c553eec37a1c" title="call back function for event process.">do_schedule</a>)(<span class="keywordtype">void</span>* <a class="code" href="../../d5/da5/classEvent.html#ae7c4ba85ebe5cb4c29ba9659c475f269" title="the context">arg</a>,std::string name,<span class="keywordtype">int</span> id);
<a name="l00029"></a><a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36">00029</a>         <span class="keywordtype">long</span> <a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36" title="scheduled time in milliseconds">sched_time</a>;
<a name="l00033"></a><a class="code" href="../../d5/da5/classEvent.html#a585aca2566e1db426a025ea97b55a74a">00033</a>         <span class="keywordtype">long</span> <a class="code" href="../../d5/da5/classEvent.html#a585aca2566e1db426a025ea97b55a74a" title="real time when the event is added to the event chain in milliseconds">join_time</a>;
<a name="l00037"></a><a class="code" href="../../d5/da5/classEvent.html#a88dc0fa91acbfbcfb1d2014491630d39">00037</a>         <span class="keyword">class </span><a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a> *<a class="code" href="../../d5/da5/classEvent.html#a88dc0fa91acbfbcfb1d2014491630d39" title="next event in the chain">next</a>;
<a name="l00041"></a><a class="code" href="../../d5/da5/classEvent.html#acccade40f77a128deeddfebb3c560d20">00041</a>         <a class="code" href="../../d5/da5/classEvent.html#a8e493c850490cee46d90c553eec37a1c" title="call back function for event process.">do_schedule</a> <a class="code" href="../../d5/da5/classEvent.html#acccade40f77a128deeddfebb3c560d20" title="call back function to deal with the event">customSchedule</a>;
<a name="l00042"></a>00042         <span class="comment">/* call back parameters */</span>
<a name="l00046"></a><a class="code" href="../../d5/da5/classEvent.html#ae7c4ba85ebe5cb4c29ba9659c475f269">00046</a>         <span class="keywordtype">void</span>* <a class="code" href="../../d5/da5/classEvent.html#ae7c4ba85ebe5cb4c29ba9659c475f269" title="the context">arg</a>;
<a name="l00050"></a><a class="code" href="../../d5/da5/classEvent.html#acaeeb3bd2c79b564a896c18f0188c264">00050</a>         std::string <a class="code" href="../../d5/da5/classEvent.html#acaeeb3bd2c79b564a896c18f0188c264" title="the queue name">queue</a>;
<a name="l00054"></a><a class="code" href="../../d5/da5/classEvent.html#af7d83ab02ea78a76a229d077a701ed5d">00054</a>         <span class="keywordtype">int</span> <a class="code" href="../../d5/da5/classEvent.html#af7d83ab02ea78a76a229d077a701ed5d" title="the message id">msgId</a>;
<a name="l00055"></a>00055 <span class="keyword">public</span>:
<a name="l00056"></a><a class="code" href="../../d5/da5/classEvent.html#a5a40dd4708297f7031e29b39e039ae10">00056</a>         <a class="code" href="../../d5/da5/classEvent.html#a5a40dd4708297f7031e29b39e039ae10">Event</a>() { <a class="code" href="../../d5/da5/classEvent.html#a88dc0fa91acbfbcfb1d2014491630d39" title="next event in the chain">next</a> = NULL;<a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36" title="scheduled time in milliseconds">sched_time</a> = 10;<a class="code" href="../../d5/da5/classEvent.html#a585aca2566e1db426a025ea97b55a74a" title="real time when the event is added to the event chain in milliseconds">join_time</a>=0;<a class="code" href="../../d5/da5/classEvent.html#acccade40f77a128deeddfebb3c560d20" title="call back function to deal with the event">customSchedule</a>=NULL;<a class="code" href="../../d5/da5/classEvent.html#acaeeb3bd2c79b564a896c18f0188c264" title="the queue name">queue</a>=<span class="stringliteral">&quot;EMPTY&quot;</span>,<a class="code" href="../../d5/da5/classEvent.html#af7d83ab02ea78a76a229d077a701ed5d" title="the message id">msgId</a>=-1;}
<a name="l00057"></a><a class="code" href="../../d5/da5/classEvent.html#af801329053df35da07ec4d03c46c63bb">00057</a>         <a class="code" href="../../d5/da5/classEvent.html#a5a40dd4708297f7031e29b39e039ae10">Event</a>(<span class="keywordtype">long</span> sched_times,<a class="code" href="../../d5/da5/classEvent.html#a8e493c850490cee46d90c553eec37a1c" title="call back function for event process.">do_schedule</a> sche,<span class="keywordtype">void</span>* ar,std::string qu,<span class="keywordtype">int</span> <span class="keywordtype">id</span>):<a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36" title="scheduled time in milliseconds">sched_time</a>(sched_times),<a class="code" href="../../d5/da5/classEvent.html#acccade40f77a128deeddfebb3c560d20" title="call back function to deal with the event">customSchedule</a>(sche)
<a name="l00058"></a>00058                 ,<a class="code" href="../../d5/da5/classEvent.html#ae7c4ba85ebe5cb4c29ba9659c475f269" title="the context">arg</a>(ar),<a class="code" href="../../d5/da5/classEvent.html#acaeeb3bd2c79b564a896c18f0188c264" title="the queue name">queue</a>(qu),<a class="code" href="../../d5/da5/classEvent.html#af7d83ab02ea78a76a229d077a701ed5d" title="the message id">msgId</a>(id){}
<a name="l00062"></a><a class="code" href="../../d5/da5/classEvent.html#ad2f1966199794fba4e23d004cf6fca0a">00062</a>         <a class="code" href="../../d5/da5/classEvent.html#ad2f1966199794fba4e23d004cf6fca0a" title="for test only">Event</a>(<span class="keywordtype">long</span> sched_times,<a class="code" href="../../d5/da5/classEvent.html#a8e493c850490cee46d90c553eec37a1c" title="call back function for event process.">do_schedule</a> sche=NULL):<a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36" title="scheduled time in milliseconds">sched_time</a>(sched_times),<a class="code" href="../../d5/da5/classEvent.html#acccade40f77a128deeddfebb3c560d20" title="call back function to deal with the event">customSchedule</a>(sche){}
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="../../d5/da5/classEvent.html#a02485379dbe8cc36e72eafa052622fe1">00064</a>         <span class="keywordtype">bool</span> <a class="code" href="../../d5/da5/classEvent.html#a02485379dbe8cc36e72eafa052622fe1">operator==</a>(<a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a>&amp; instance){
<a name="l00065"></a>00065                 <span class="keywordflow">return</span> instance.<a class="code" href="../../d5/da5/classEvent.html#af7d83ab02ea78a76a229d077a701ed5d" title="the message id">msgId</a>==<a class="code" href="../../d5/da5/classEvent.html#af7d83ab02ea78a76a229d077a701ed5d" title="the message id">msgId</a>&amp;&amp;instance.<a class="code" href="../../d5/da5/classEvent.html#acaeeb3bd2c79b564a896c18f0188c264" title="the queue name">queue</a>.compare(<a class="code" href="../../d5/da5/classEvent.html#acaeeb3bd2c79b564a896c18f0188c264" title="the queue name">queue</a>)==0&amp;&amp;instance.<a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36" title="scheduled time in milliseconds">sched_time</a>==<a class="code" href="../../d5/da5/classEvent.html#af44247209b624738228d66efe4a5eb36" title="scheduled time in milliseconds">sched_time</a>;
<a name="l00066"></a>00066         }
<a name="l00067"></a>00067 };
<a name="l00072"></a><a class="code" href="../../df/dd4/classEventChain.html">00072</a> <span class="keyword">class </span><a class="code" href="../../df/dd4/classEventChain.html" title="timeout chain class - the timeout process core">EventChain</a>{
<a name="l00073"></a>00073 <span class="keyword">private</span>:
<a name="l00077"></a><a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189">00077</a>         <a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a> *<a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a>;
<a name="l00081"></a><a class="code" href="../../df/dd4/classEventChain.html#a18d260ab11be32921c0048f9baee010f">00081</a>         pthread_t <a class="code" href="../../df/dd4/classEventChain.html#a18d260ab11be32921c0048f9baee010f" title="the thread id the do the event process">pid</a>;
<a name="l00085"></a><a class="code" href="../../df/dd4/classEventChain.html#a07bb206a91428aa03e3167760357bc57">00085</a>         pthread_cond_t <a class="code" href="../../df/dd4/classEventChain.html#a07bb206a91428aa03e3167760357bc57" title="condition var to avoid overhead loop">qready</a>;
<a name="l00089"></a><a class="code" href="../../df/dd4/classEventChain.html#ade765e56690d9ed14ade46e379a52680">00089</a>         pthread_mutex_t <a class="code" href="../../df/dd4/classEventChain.html#ade765e56690d9ed14ade46e379a52680" title="mutex to avoid racing">qlock</a>;
<a name="l00093"></a>00093         <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="../../df/dd4/classEventChain.html#a009f6fec4bfd5adc7c28c7c6acc8d317" title="helper method to deal with dead lock.">Cleanup</a>(<span class="keywordtype">void</span>* arg);
<a name="l00094"></a>00094 <span class="keyword">public</span>:
<a name="l00095"></a><a class="code" href="../../df/dd4/classEventChain.html#ada7e8a70f9a8d1401ae8688d1c229c48">00095</a>         <a class="code" href="../../df/dd4/classEventChain.html#ada7e8a70f9a8d1401ae8688d1c229c48">EventChain</a>():<a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a>(NULL),<a class="code" href="../../df/dd4/classEventChain.html#a18d260ab11be32921c0048f9baee010f" title="the thread id the do the event process">pid</a>(0),<a class="code" href="../../df/dd4/classEventChain.html#a07bb206a91428aa03e3167760357bc57" title="condition var to avoid overhead loop">qready</a>(PTHREAD_COND_INITIALIZER),<a class="code" href="../../df/dd4/classEventChain.html#ade765e56690d9ed14ade46e379a52680" title="mutex to avoid racing">qlock</a>(PTHREAD_MUTEX_INITIALIZER){
<a name="l00096"></a>00096         }
<a name="l00097"></a><a class="code" href="../../df/dd4/classEventChain.html#a236195bf33b701dbc51aed3f2626a3ce">00097</a>         <span class="keyword">virtual</span> <a class="code" href="../../df/dd4/classEventChain.html#a236195bf33b701dbc51aed3f2626a3ce">~EventChain</a>(){
<a name="l00098"></a>00098                 <span class="keywordflow">if</span>(<a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a>){
<a name="l00099"></a>00099                         <span class="keywordflow">while</span>(<a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a>-&gt;<a class="code" href="../../d5/da5/classEvent.html#a88dc0fa91acbfbcfb1d2014491630d39" title="next event in the chain">next</a>!=NULL){
<a name="l00100"></a>00100                                 <a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a>* e = <a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a>;
<a name="l00101"></a>00101                                 <a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a> = <a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a>-&gt;<a class="code" href="../../d5/da5/classEvent.html#a88dc0fa91acbfbcfb1d2014491630d39" title="next event in the chain">next</a>;
<a name="l00102"></a>00102                                 <span class="keyword">delete</span> e;
<a name="l00103"></a>00103                         }
<a name="l00104"></a>00104                         <span class="keyword">delete</span> <a class="code" href="../../df/dd4/classEventChain.html#ae1a1e5817ae1441dd667bf8cc61d2189" title="head event in the chain">head</a> ;
<a name="l00105"></a>00105                 }
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107 
<a name="l00111"></a>00111         <span class="keywordtype">void</span> <a class="code" href="../../df/dd4/classEventChain.html#a5946605e94f28745049b188436d1b4d9" title="start handling event chain, please do not call it directly, call Start() instead">Run</a>();
<a name="l00117"></a>00117         <span class="keywordtype">bool</span> <a class="code" href="../../df/dd4/classEventChain.html#a16e7a78c2ed7f99f317bd3e07af1d8f9" title="call it to start process event chain">Start</a>();
<a name="l00125"></a>00125         <span class="keywordtype">bool</span> <a class="code" href="../../df/dd4/classEventChain.html#aa1291ec4c607b26362ce57269f90e7cb" title="call it to stop process event chain.">Stop</a>();
<a name="l00131"></a>00131         <span class="keywordtype">void</span> <a class="code" href="../../df/dd4/classEventChain.html#ac986b5d2267157e6e8bb6deadef8b973" title="schedule a new event">Schedule</a>(<a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a>* e);
<a name="l00141"></a>00141         <span class="keywordtype">void</span> <a class="code" href="../../df/dd4/classEventChain.html#af62373dcc9dd1b677eb957f8ba2c46c5" title="cancel an event">Cancel</a>(<a class="code" href="../../d5/da5/classEvent.html" title="MsgLock.h.">Event</a>* e);
<a name="l00142"></a>00142 };
<a name="l00143"></a>00143 
<a name="l00149"></a><a class="code" href="../../da/d01/classMsgLock.html">00149</a> <span class="keyword">class </span><a class="code" href="../../da/d01/classMsgLock.html" title="class to handle message lock and unlock.">MsgLock</a>{
<a name="l00150"></a>00150 <span class="keyword">private</span>:
<a name="l00151"></a><a class="code" href="../../da/d01/classMsgLock.html#a31f44a96cdf2cef27b8543f530231631">00151</a>         <a class="code" href="../../df/dd4/classEventChain.html" title="timeout chain class - the timeout process core">EventChain</a>* <a class="code" href="../../da/d01/classMsgLock.html#a31f44a96cdf2cef27b8543f530231631">chain_core</a>;
<a name="l00155"></a><a class="code" href="../../da/d01/classMsgLock.html#a15c1b0e57d86b2598e5b57b43094c4c6">00155</a>     std::multimap&lt;std::string,int&gt; <a class="code" href="../../da/d01/classMsgLock.html#a15c1b0e57d86b2598e5b57b43094c4c6" title="locked messages,i.e.">mDatas</a>;
<a name="l00159"></a><a class="code" href="../../da/d01/classMsgLock.html#a39cad315b694113c3aa552ba84db9093">00159</a>     <span class="keywordtype">long</span> <a class="code" href="../../da/d01/classMsgLock.html#a39cad315b694113c3aa552ba84db9093" title="default time out for the message lock, 5s in default">defaultTmout</a>;
<a name="l00160"></a><a class="code" href="../../da/d01/classMsgLock.html#a94499ef81482492775a556e26ff6fe3f">00160</a>         pthread_cond_t <a class="code" href="../../da/d01/classMsgLock.html#a94499ef81482492775a556e26ff6fe3f">qready</a>;
<a name="l00161"></a><a class="code" href="../../da/d01/classMsgLock.html#a8d00c3f7af52fef41cc98c661e1df541">00161</a>         pthread_mutex_t <a class="code" href="../../da/d01/classMsgLock.html#a8d00c3f7af52fef41cc98c661e1df541">qlock</a>;
<a name="l00167"></a>00167     <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#ae10ea239514a1e25b04e1cbff387f60b" title="Whether the giving msg id in the giving queue is already lock returns true if already lock...">IsExist</a>(std::string queueName,<span class="keywordtype">int</span> msgId);
<a name="l00173"></a>00173     <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#a641f1a5b90f5eb59f3139eb4a311267a" title="insert the message to the lock list.">Insert</a>(std::string queueName,<span class="keywordtype">int</span> msgId);
<a name="l00182"></a>00182     <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#a309cdb87539f105fe41ed0130fa21f5b" title="Delete the locked message lock it when processing.">Del</a>(std::string queueName,<span class="keywordtype">int</span> msgId);
<a name="l00183"></a>00183 <span class="keyword">public</span>:
<a name="l00184"></a><a class="code" href="../../da/d01/classMsgLock.html#a29a504bb53629c05ecb9e09dc8bd08ec">00184</a>         <a class="code" href="../../da/d01/classMsgLock.html#a29a504bb53629c05ecb9e09dc8bd08ec">MsgLock</a>():<a class="code" href="../../da/d01/classMsgLock.html#a39cad315b694113c3aa552ba84db9093" title="default time out for the message lock, 5s in default">defaultTmout</a>(5000),<a class="code" href="../../da/d01/classMsgLock.html#a31f44a96cdf2cef27b8543f530231631">chain_core</a>(new <a class="code" href="../../df/dd4/classEventChain.html" title="timeout chain class - the timeout process core">EventChain</a>()),<a class="code" href="../../da/d01/classMsgLock.html#a94499ef81482492775a556e26ff6fe3f">qready</a>(PTHREAD_COND_INITIALIZER),<a class="code" href="../../da/d01/classMsgLock.html#a8d00c3f7af52fef41cc98c661e1df541">qlock</a>(PTHREAD_MUTEX_INITIALIZER){ }
<a name="l00185"></a><a class="code" href="../../da/d01/classMsgLock.html#a6f2097905a4ed2e3a0129de845d5fe63">00185</a>         <a class="code" href="../../da/d01/classMsgLock.html#a6f2097905a4ed2e3a0129de845d5fe63">MsgLock</a>(<span class="keywordtype">long</span> tmout):<a class="code" href="../../da/d01/classMsgLock.html#a39cad315b694113c3aa552ba84db9093" title="default time out for the message lock, 5s in default">defaultTmout</a>(tmout),<a class="code" href="../../da/d01/classMsgLock.html#a31f44a96cdf2cef27b8543f530231631">chain_core</a>(new <a class="code" href="../../df/dd4/classEventChain.html" title="timeout chain class - the timeout process core">EventChain</a>()),<a class="code" href="../../da/d01/classMsgLock.html#a94499ef81482492775a556e26ff6fe3f">qready</a>(PTHREAD_COND_INITIALIZER),<a class="code" href="../../da/d01/classMsgLock.html#a8d00c3f7af52fef41cc98c661e1df541">qlock</a>(PTHREAD_MUTEX_INITIALIZER){}
<a name="l00190"></a>00190         <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#abefa80b2195e058a42e28496607c1781" title="lock the message returns true if successfully lock, false if the message is already locked by others...">Lock</a>(std::string queueName,<span class="keywordtype">int</span> msgId);<span class="comment">//should lock it when processing</span>
<a name="l00195"></a>00195 <span class="comment"></span>        <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#ab13af89818d9c55ad8a2b1350f83c123" title="unlock the message this will always return true">UnLock</a>(std::string queueName,<span class="keywordtype">int</span> msgId);
<a name="l00200"></a>00200         <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#aabe3da15ec94dbb5ec28cb1122d01f1f" title="start the event chain process.">Start</a>();
<a name="l00205"></a>00205         <span class="keywordtype">bool</span> <a class="code" href="../../da/d01/classMsgLock.html#aacf751266c7c5bd26e96950f56e59ab4" title="stop the event chain process.">Stop</a>();
<a name="l00206"></a>00206 
<a name="l00216"></a>00216         <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="../../da/d01/classMsgLock.html#af2724aaff9e232ca798de9f3ec8f65c8" title="call back function to do with the event process: unlock the message and delete the event from the eve...">ReleaseLock</a>(<span class="keywordtype">void</span>* arg,std::string name,<span class="keywordtype">int</span> <span class="keywordtype">id</span>);
<a name="l00217"></a>00217 };
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d6/da8/MsgLock_8h.html">MsgLock.h</a>      </li>

    <li class="footer">Generated on Sun May 20 2012 22:27:52 for SQSMaster by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
